from PIL import Image
import numpy as np
import sys

HEIGHT_OPT = (16 * 6 + 1)  # == 97


### TODO: Load from file
GROUND_TEXTURE = [   # 20x16
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x71fc,0x71fc,
    0x0,0x0,0x0,0xff0,0xff0,0xff0,0xeff0,0xeff7,0xeff7,0xeff7,0xefff,0xefff,0xefff,0xefff,0xefff,0xefff,0xefff,0xefff,0xffff,0xffff,
    0x0,0x3f8,0x3f8,0xfbfc,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
    0xfe0,0x7fef,0x7fef,0x7fef,0x7fef,0x7fef,0x7fff,0x7fff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
    0xf838,0xf839,0xf83f,0xf83f,0xf83f,0xf87f,0xf8ff,0xf8ff,0xf8ff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
    0xf,0xf,0x3fff,0x3fff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1e0,0x1e0,0x1e0,0xfe0,0xfe0,0xfe0,0xfe0,0xfe0,0xfe0,0xfe0,0xfe0,0xffe0,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
    0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
]

if __name__ == '__main__':
    img = np.array(Image.open(sys.argv[1]))

    print('static __data_chip uint16_t grass[97 * 20 * 6] = {')
    for bpn in range(0, 6):   # bitplanes
        # First line empty
        for _ in range(0,20):
            print('0x0, ', end='')
        print('')
        
        # for sector in range(0,6):
        for sector in [0,2,4,1,3,5]:
            for line in range(0,16):
                for word in range(0,20):
                    if sector != bpn:
                        print('0x0, ', end='')
                    else:
                        val = GROUND_TEXTURE[line*20 + word]
                        print(hex(val),',', end='')
                print('')

    print('};')
