from PIL import Image
import numpy as np
import sys

HEIGHT_OPT = (16 * 6 + 1)  # == 97


### TODO: Load from file
GROUND_TEXTURE = []

if __name__ == '__main__':
    img = np.array(Image.open(sys.argv[1]))


    for line in img:
        i = 0
        val = 0
        for px in line:
            if px[0] == 0:
                val |= 0x8000 >> i
            i += 1
            if i == 16:
                GROUND_TEXTURE.append(val)
                i = 0
                val = 0

    print('static __data_chip uint16_t grass[20 * 16] = {')
    for i in range(len(GROUND_TEXTURE)):
        print(hex(GROUND_TEXTURE[i]) + ', ', end='')
        if ((i+1) % 20 == 0):
            print('')

    print('};')


#   SetColor(9,  0x111); // 1st LAYER  bpl 1
#   SetColor(10, 0x333); // 3rd LAYER  bpl 3
#   SetColor(11, 0x222); // 2nd LAYER  bpl 1 & bpl 3

# GROUND_TEXTURE = [   # 20x16
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x1fc,0x71fc,0x71fc,
#     0x0,0x0,0x0,0xff0,0xff0,0xff0,0xeff0,0xeff7,0xeff7,0xeff7,0xefff,0xefff,0xefff,0xefff,0xefff,0xefff,0xefff,0xefff,0xffff,0xffff,
#     0x0,0x3f8,0x3f8,0xfbfc,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xfe0,0x7fef,0x7fef,0x7fef,0x7fef,0x7fef,0x7fff,0x7fff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xf838,0xf839,0xf83f,0xf83f,0xf83f,0xf87f,0xf8ff,0xf8ff,0xf8ff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xf,0xf,0x3fff,0x3fff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,0xbfff,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1e0,0x1e0,0x1e0,0xfe0,0xfe0,0xfe0,0xfe0,0xfe0,0xfe0,0xfe0,0xfe0,0xffe0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
# ]
# GROUND_TEXTURE = [   # 20x16 TEST VERSION
#     0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
#     0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff,0x0,0xffff
# ]